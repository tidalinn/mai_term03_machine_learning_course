# ML System Design Doc - Прогнозирование кухни для блюда с рекомендацией ресторана

>## Термины и определения
>
>* *Сервис* - система прогнозирования кухни и рекомендации ресторана на её основе.
>* *Запрос* - текст или изображение.
>* *Пользователь* - физическое лицо, которое направляет запрос в сервис.

## 1 Цели и предпосылки

### 1.1 Потребность в разработке

* *Бизнес-цель:* помощь пользователям в поиске ресторанов в округе в зависимости от кухни, основанной на их пожеланиях.

* *Польза:* при возникновении желания съесть что-то конкретное пользователь сразу сможет узнать, какие рестораны в округе предоставляют искомое блюдо. 
  
### 1.2. Бизнес-требования и ограничения

* *Логика работы ML:* в основе принцип запрос-ответ: пользователь пишет название блюда или загружает его фотографию, а сервис выдаёт рестораны в округе, его предоставляющие.
  
* *Бизнес-требования:* запрос-ответ не должен занимать более 10 секунд (в идеале 2-3 секунды).

* *Успешная модель:* правильно классифицирующая блюда как по текстовым запросам, так и по изображениям.

* *Сценарии использования:* 
  * <ins>input:</ins> "балоньезе" -> [обработка сервисом запроса -> итальянская кухня] -> список ресторанов, которые предоставляют пасту балоньезе и итальянскую кухню.
  * <ins>input:</ins> фото бургера -> [обработка сервисом запроса -> американская кухня] -> список ресторанов, которые предоставляют бургеры и американскую кухню.
  
* *Возможные пути развития проекта:* в случае отсутствия ответа на заданный запрос рекомендовать рестораны с похожими блюдами.
  
* *Среда:* разработка на персональном компьютере.
  
* *Стэк технологий:* Python.
  
* *Данные:* open source датасет [Delivery Hero Recommendation Dataset](https://dl.acm.org/doi/pdf/10.1145/3604915.3610242) (город: Стокгольм) и датасет [Food Images (Food-101)](https://www.kaggle.com/datasets/kmader/food41).
  
* *Исполнители:* одна человекоединица в лице DataScientist'а.
  

### 1.3 Что входит в scope проекта, что не входит

* *Ожидания от проекта:* классификация кухни по входящему текстовому запросу или изображению, рекомендация на основании результатов классификации.
  
* *Что не будет закрыто:* детальный дизайн сервиса.
  
* *Образ результата (код):* Jupyter-ноутбуки с проведённым EDA и обученной моделью классификации.

* *Образ результата (сервис):* строка ввода/загрузки с выводом текстового ответа.
  
* *Планируемый технический долг:* расширение классифицируемых блюд.

### 1.4 Предпосылки решения

* *Общие предпосылки решения, используемые в системе:* признаками являются информация о заказе, блюде и ресторане его предлагающем, целевым признаком - вид кухни.

## 2 Методология

### 2.1 Постановка задач

* *Этап 1:* проведение EDA.
* *Этап 2:* обучение модели классификации кухни.
* *Этап 3:* формирование рекомендаций ресторанов на основе полученных предсказаний.
* *Этап 4:* deploy модели

### 2.2 Блок-схема решения

Этап | Описание | Задачи
-|-|-
**1** | **Проведение EDA** | 
1.1 | Выбор и сбор данных | Скачивание, загрузка данных и подготовка данных
1.2 | Предобработка данных | Выявление аномалий, пропусков, дубликатов
1.3 | Анализ данных | Обнаружение зависимостей
**2** | **Обучение модели классификации** | 
2.1 | Полдготовка к обучению модели | Определение метрик и функции потерь, выбор моделей, формирование baseline
2.2 | Обучение модели | Проверка моделей, подбор лучших параметров, достижение заявленного порога, выбор лучшей модели
2.3 | Тестирование модели | Проверка корректности восприятия модели на тестовых данных
**3** | **Формирование рекомендаций** |
3.1 | Выдача рекомендаций | Выведение ресторанов, предоставляющих блюда классифицированной кухни
**4** | **Deploy модели** |
4.1 | Подготовка модели | Устранение проблем в исходных данных и настройка pipeline модели
4.2 | Формирование интерфейса сервиса | Создание строки ввода/загрузки и окна с текстовым выводом результата
4.3 | Deploy модели | Тестирование и проверка отказоустойчивости сервиса

### 2.3 Основные аспекты

* *Данные*
* *Метрики*
* *Функция потерь*
* *Порог*
* *Baseline*
* *Результаты*

## 4 Внедрение

### 4.1 Архитектура решения

Реализация модели, загрузка на хостинг?

### 4.2 Инфраструктура и масштабируемость

* Автономный сервис.

### 4.3 Требования к работе системы

* Корректная классификация входящих запросов.
* В случае отсутствия искомого запроса сервис должен предлагать аналог, либо уведомлять об отсуствии блюда в системе.

### 4.4 Безопасность системы

Сервис безопасен и не предоставляет контент, не имеющий отношение к еде.

### 4.5 Безопасность данных

Сервис предоставляет исключительно рекомендуемые рестораны.

### 4.6 Издержки

?

### 4.7 Интеграции

?

### 4.8 Риски

?